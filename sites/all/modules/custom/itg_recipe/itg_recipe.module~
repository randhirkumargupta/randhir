<?php

/**
 * @file
 * ITG Recipe module.
 *
 * Provides customizations and functions for Recipe.
 *
 */

/**
 * Implemets hook_form_alter().
 * @param type $form
 * @param type $form_state
 * @param type $form_id
 */
function itg_recipe_form_alter(&$form, &$form_state, $form_id) {
  global $user, $base_url;  

    switch ($form_id) {
    case 'recipe_node_form':
      $form['actions']['cancel'] = array(
        '#markup' => l(t('Cancel'), 'recipe-management', array('attributes' => array('class' => 'button'))),
        '#weight' => 20,
      );     
      $form['#after_build'][] = 'itg_recipe_after_build';
    break;      
  }
}

/**
 * After build for Recipe form.
 * @param type $form
 * @param type $form_state
 */
function itg_recipe_after_build($form, &$form_state) {
  global $user;
  
  global $user, $base_url;
  unset($form['metatags']['intro_text']['#markup']);
  
  $settings = array();
  $settings['base_url'] = $base_url;
  $settings['uid'] = $user->uid;

  drupal_add_js(array('itg_recipe' => array('settings' => $settings)), array('type' => 'setting'));
  drupal_add_js(drupal_get_path('module', 'itg_recipe') . '/js/itg_recipe.js', array('weight' => 1));
  return $form;
}
