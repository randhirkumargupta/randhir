<?php

/**
 * @file
 * The ITG Image Search module.
 *
 * Contains functionality related to Image Searching.
 *
 */

/**
 * Implements apachesolr_image_apachesolr_index_document_build().
 * {@inheritdoc}
 */
function apachesolr_image_apachesolr_index_document_build($document, $node, $namespace) {
  
  if (isset($node->field_story_extra_large_image['und']['0']['alt']))
  { $document->addField('sm_alttext', $node->field_story_extra_large_image['und']['0']['alt']);
    $document->addField('sm_image_title', $node->field_story_extra_large_image['und']['0']['title']);
  }
    if (isset($node->field_story_extra_small_image['und']['0']['alt']))
  { $document->addField('sm_alttext', $node->field_story_extra_small_image['und']['0']['alt']);
    $document->addField('sm_image_title', $node->field_story_extra_small_image['und']['0']['title']);
  }
  if (isset($node->field_story_large_image['und']['0']['alt']))
  { $document->addField('sm_alttext', $node->field_story_large_image['und']['0']['alt']);
    $document->addField('sm_image_title', $node->field_story_large_image['und']['0']['title']);
  }
  if (isset($node->field_story_small_image['und']['0']['alt']))
  { $document->addField('sm_alttext', $node->field_story_small_image['und']['0']['alt']);
    $document->addField('sm_image_title', $node->field_story_small_image['und']['0']['title']);
  }
      if (isset($node->field_story_medium_image['und']['0']['alt']))
  { $document->addField('sm_alttext', $node->field_story_medium_image['und']['0']['alt']);
    $document->addField('sm_image_title', $node->field_story_medium_image['und']['0']['title']);
  }
 
  foreach ($node->field_gallery_image['und'] as $key => $fieldval) {
     $fieldata=entity_load('field_collection_item', array($fieldval['value']));
     
    if(isset($fieldata[$fieldval['value']]->field_images['und'][0]['alt']))
    {
        $document->addField('sm_alttext', $fieldata[$fieldval['value']]->field_images['und'][0]['alt']);
    }
    if(isset($fieldata[$fieldval['value']]->field_image_caption['und'][0]['value']))
    {
        $document->addField('sm_image_title', $fieldata[$fieldval['value']]->field_image_caption['und'][0]['value']);
    }
  }

  
}