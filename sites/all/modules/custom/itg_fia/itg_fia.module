<?php

/**
 * Implements hook_menu().
 */
function itg_fia_menu() {
  // Implementing the menu item for itg_fia.
  $items['itg_fia.xml'] = array(
    'title' => 'Taxonomy Comments',
    'description' => 'list fia data',
    'page callback' => 'itg_fia_data',
    'access callback' => TRUE,
    'page arguments' => array('itg_fia_data'),
    'file' => 'include/itg_fia.inc',
  );
  $items['admin/structure/itg_fia_config'] = array(
    'title' => 'ITG FIA Configuration',
    'description' => 'Add your appid',
    'page callback' => 'drupal_get_form',
    'access callback' => 'user_access',
    'page arguments' => array('itg_fia_config_form'),
    'type' => MENU_LOCAL_TASK,
    'file' => 'include/itg_fia.inc',
    'weight' => 100,
  );

  return $items;
}


/**
 * Implements hook_html_head_alter().
 */
function itg_fia_html_head_alter(&$head_elements) {
  $fia_pagesid = variable_get('itg_fia_config', '');
  if (!empty($fia_pagesid)) {
    $head_elements['fia_pagesid'] = array(
      '#type' => 'html_tag',
      '#tag' => 'meta',
      '#attributes' => array(
        'property' => 'fb:pages',
        'content' => $fia_pagesid
      ),
    );
  }
}

/**
 * Implements hook_uninstall().
 */
function itg_fia_uninstall() {
  // Delete variables.
  variable_del('itg_fia_config');
}

function itg_fia_split_by_words($text, $splitLength = 200) {
	// explode the text into an array of words
	$wordArray = explode(' ', $text);
	$count = 0;
	// Too many words
	while( sizeof($wordArray) > $count )
	{
		// Split words into two arrays
		$firstWordArray = array_slice($wordArray, $count, $splitLength);
		//$lastWordArray = array_slice($wordArray, $splitLength+1, sizeof($wordArray));

		// Turn array back into two split strings 
		$firstString = implode(' ', $firstWordArray);
		//$lastString = implode(' ', $lastWordArray);
		$ad_string = "<figure class='op-ad'> <iframe width='300' height='250' style='border:0; margin:0;' src='https://www.facebook.com/adnw_request?placement=1634971070080984_1635110376733720&adtype=banner300x250'></iframe></figure>";
		$return_string .= $firstString.$ad_string;
		$count = $count+$splitLength+1;
		
		//return array($firstString, $lastString);
	}
	// if our array is under the limit, just send it straight back
	return $return_string;
}
